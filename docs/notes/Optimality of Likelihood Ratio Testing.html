
<!DOCTYPE html>
    <head>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
        <link rel="stylesheet" type="text/css" href="../styles/styles.css">
        <link rel="icon" href="assets/icon.ico" />
        <meta name="google-site-verification" content="gGsyj98Hmr9mZj0-DQzJIAdOP3eJXZJZnM4_NF8Mai8" />
        <meta charset="utf-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"> 
        <title>Mara Daniels - MIT</title>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
            onload="renderMathInElement(document.body, {
                delimiters: [
                    {left: '$$', right: '$$', display: true},
                    {left: '$', right: '$', display: false},
                ],
                macros: {
                    '\\saeq': '\\{#1\\}',
                    '\\linf': '\\lim_{n \\to \\infty}',
                    '\\Alpha': '\\mathcal{A}',
                    '\\norm': '\\left\\lVert#1\\right\\rVert',
                    '\\ct': 'C^\\infty_c ( #1 )',
                    '\\lloc': 'L^1_{\\mathsf{loc}}( #1 )',
                    '\\Scr': '\\mathscr{S}',
                    '\\tmpr': '\\mathscr{S}',
                    '\\limnf': '\\liminf \\limits_{#1}',
                    '\\limsp': '\\limsup \\limits_{#1}',
                    '\\R': '{\\mathbb R}',
                    '\\C': '{\\mathbb C}',
                    '\\N': '{\\mathbb N}',
                    '\\Q': '{\\mathbb Q}',
                    '\\H': '{\\mathbb H}',
                    '\\S': '{\\mathbb S}',
                    '\\Z': '{\\mathbb Z}',
                    '\\E': '{\\mathbb E}',
                    '\\Var': '\\mathsf{Var}',
                    '\\Cov': '\\mathsf{Cov}',
                    '\\KL': '\\mathsf{KL}',
                    '\\Ent': '\\mathsf{Ent}',
                    '\\F': '{\\mathbb F}',
                    '\\Acl': '\\mathcal{A}',
                    '\\Bcl': '\\mathcal{B}',
                    '\\Ccl': '\\mathcal{C}',
                    '\\Dcl': '\\mathcal{D}',
                    '\\Ecl': '\\mathcal{E}',
                    '\\Fcl': '\\mathcal{F}',
                    '\\Gcl': '\\mathcal{G}',
                    '\\Hcl': '\\mathcal{H}',
                    '\\Jcl': '\\mathcal{J}',
                    '\\Kcl': '\\mathcal{K}',
                    '\\Lcl': '\\mathcal{L}',
                    '\\Mcl': '\\mathcal{M}',
                    '\\Ncl': '\\mathcal{N}',
                    '\\Ocl': '\\mathcal{O}',
                    '\\Pcl': '\\mathcal{P}',
                    '\\Qcl': '\\mathcal{Q}',
                    '\\Rcl': '\\mathcal{R}',
                    '\\Scl': '\\mathcal{S}',
                    '\\Tcl': '\\mathcal{T}',
                    '\\Ucl': '\\mathcal{U}',
                    '\\Vcl': '\\mathcal{V}',
                    '\\Wcl': '\\mathcal{W}',
                    '\\Xcl': '\\mathcal{X}',
                    '\\Ycl': '\\mathcal{Y}',
                    '\\Zcl': '\\mathcal{Z}',
                    '\\diag': '\\mathrm{diag}',
                    '\\supp': '\\mathrm{supp}',
                    '\\diam': '\\mathrm{diam}',
                    '\\sgn': '\\mathrm{sgn}',
                    '\\im': '\\mathrm{Im}',
                    '\\lcm': '\\mathrm{lcm}',
                    '\\aut': '\\mathrm{Aut}',
                    '\\inn': '\\mathrm{Inn}',
                    '\\rg': '\\mathrm{rg}',
                    '\\vol': '\\mathrm{vol}',
                    '\\Pr': '\\mathrm{Pr}',
                    '\\Tr': '\\mathrm{Tr}',
                    '\\eps': '\\varepsilon',
                    '\\charfct': '\\mathds{1}',
                    '\\nullfct': '{\\bf 0}',
                    '\\as': '\\text{a.s.}\\xspace',
                    '\\argmax': '\\mathop{\\mathrm{arg\\,max}}',
                    '\\argmin': '\\mathop{\\mathrm{arg\\,min}}',
                    '\\esssup': '\\mathop{\\mathrm{ess\\,sup}}',
                    '\\th': '\\hat{\\theta}',
                    '\\pto': '\\stackrel{p}{\\longrightarrow}',
                    '\\dto': '\\stackrel{d}{\\longrightarrow}',
                    '\\asto': '\\stackrel{a.s.}{\\longrightarrow}',
                    '\\coloneqq': ':='
                }
            });">
            </script>
    </head>
    <body>
        <div class="row">
            <div class="col-lg-12 col-xl-8 offset-xl-2"> 
            <h1>Optimality of Likelihood Ratio Testing</h1>
<p>
One way to judge the quality of a <a href="Likelihood Ratio Test.html">likelihood ratio hypothesis test</a> is to use the <a href="Hypothesis Testing.html">weighted error probability</a>,
$$\Ecl_\omega(P_0, P_1, \Psi) \coloneqq \omega P_0(\Psi(y) \not = 0) + (1-\omega) P_1(\Psi(y) \not = 1).$$
It turns out that this metric is minimized by the likelihood ratio test under an appropriate choice of threshold.
</p>
<h3 id="equally-weighted-case-le-cams-bound">Equally Weighted Case (Le Cam's bound)</h3>
<hr />
<p>
<strong>Theorem</strong>: let $P_0, P_1$ be null and alternative hypotheses and let $\Ecl_{1/2}(P_0, P_1, \Psi)$ be the <a href="Hypothesis Testing.html">equally weighted error</a> of the test $\Psi$, corresponding to $\omega = 1/2$. Then $\Ecl(P_0, P_1, \Psi) \geq \frac{1}{2}\left(1 - \|P_0 - P_1\|_{TV}\right)$.
</p>
<hr />
<p>
<em>Proof</em>. The TV is defined as $\|P_0 - P_1\|_{TV} = \sup_{\Acl \text{ msbrl}} P_0(\Acl) - P_1(\Acl)$. Choosing $\Acl = 1\{y : \Psi(y) = 1\}$,
$$
\begin{aligned}
\Ecl_{1/2}(P_0, P_1, \Psi) & = \frac{1}{2}\left(P_0(\Acl) + P_1(\Acl^c)\right) = \frac{1}{2} - \frac{1}{2}(P_1(\Acl) - P_0(\Acl)) \geq \frac{1}{2}(1-\|P_0-P_1\|_{TV}).
\end{aligned}
$$
<span class="qed" />
</p>
<p>
<strong>Equality case</strong>: the test
$$
\Psi(y) = \begin{cases}
1 & \frac{P_1(y)}{P_0(y)} > 1 \\
0 & \text{else}
\end{cases}
$$
achieves this bound. This test is equal to $1_\Acl(y)$ for $\Acl = \{y : P_1(y) > P_0(y)\}$, which attains
$$
\Ecl_{1/2}(P_0, P_1, \Psi) = \frac{1}{2} - \frac{1}{2}(P_1(\Acl) - P_0(\Acl)) = \frac{1}{2} - \frac{1}{2} \|P_0 - P_1\|_{TV}.
$$
</p>
<h3 id="optimal-weighted-error">Optimal Weighted Error</h3>
<hr />
<p>
<strong>Theorem (Optimal Weighted Error via Deterministic LRT)</strong>: let $P_0, P_1$ be null and alternative hypotheses and set
$$
\Psi^*_\omega(y) \coloneqq \begin{cases} 1 & \frac{P_1(y)}{P_0(y)} \geq \frac{1-\omega}{\omega} \\
0 & \text{else} \end{cases}
$$
Then $\Ecl_\omega(P_0, P_1, \Psi^*_\omega) \leq \Ecl_\omega(P_0, P_1, \Psi)$ for any test $\Psi_\omega$.
</p>
<hr />
<p>
<em>Proof</em>. the basic idea is that $\Psi^*_\omega(y)$ is extremal (minimal) among functions bounded by $[0, 1]$ for the quantity $\Ecl_\omega(P_0, P_1, \Psi)$. We wish to minimize
$$
\Ecl_\omega(P_0, P_1, \Psi^*_\omega) = \omega \E_0[\Psi^*_\omega(y)] - (1-\omega) \E_1[\Psi^*_\omega(y)] + 1-\omega = \int \Psi^*_\omega(y) \underbrace{(\omega P_0(y) - (1-\omega)P_1(y))}_{I(y)} \, dy + 1 - \omega
$$
Clearly, the quantity is minimized when $\Phi^*_\omega(y) = 1\{y : I(y) \leq 0\}$, which is equivalent to the claim. <span class="qed" />
</p>
<p>
<strong>Non-uniqueness</strong>: in the above proof, the behavior of $\Phi^*_\omega(y)$ is actually arbitrary at points where $I(y) = 0$, since it does not change the value of $\Ecl_\omega(P_0, P_1, \Psi^*_\omega)$. In particular, $\Psi^*_\omega(y)$ can take values in the interior of $[0, 1]$. Changing its values on this set <span style="font-style: italic">does change its false alarm and detection rates</span>, leading to an entire family of optimal tests with different false alarm rate/power characteristics.
</p>
<p>
This observation is often useful when working with the <a href="Hypothesis Testing.html">Neyman-Pearson criteria</a>, where the goal is to maximize power subject to an upper bound on the false alarm rate.
</p>
<p>
In practice, a hypothesis test that outputs $\Psi^*_\omega(y) \in (0, 1)$ is impractical, since we can only interpret a binary choice to either accept or reject the null. Instead, this behavior can be simulated using a <em>randomized test</em> which returns $\Psi_\omega^*(y) \sim \mathsf{Ber}(p)$.
</p>
<p>
<strong>Geometric Intuition</strong>: let $\alpha(\Psi) = P_0(\Psi(y) \not = 0)$, $\beta(\Psi) = P_1(\Psi(y) = 1)$ be the false alarm rate and the power, respectively. The weighted error is linear in $(\alpha, \beta)$, and in fact:
</p>
<ul>
<li>it is constant on lines of the form $\beta = \frac{1-\omega}{\omega} \alpha + c$.
</li>
<li>it is monotonic on perpendicular lines $\beta = \frac{-\omega}{1-\omega} + c'$.
</li>
</ul>
<p>
So, the optimal $\Psi^*_\omega(y)$ can be viewed as a tangent point to some line with slope $(1-\omega)/ \omega$. A family of non-unique optimal tests corresponds to the case when the realizable set $\{(\alpha(\Psi), \beta(\Psi)) \}$ has a linear boundary that intersects its tangent line.
</p>
<p>
<img src="assets/IMG<em>480519FC0FA3-1.jpeg" alt="IMG</em>480519FC0FA3-1.jpeg" style="width: 100%; height: auto;">
</p>
<h3 id="neyman-pearson-optimality">Neyman-Pearson Optimality</h3>
<p>
The discussion in the previous section also identifies the optimal test for the Neyman-Pearson critera.
</p>
<p>
<strong>Theorem (Neyman-Pearson Optimal LRT)</strong>: for any $\bar{\alpha} \in [0, 1]$, there exists a threshold $t(\bar{\alpha})$ such that the Neyman-Pearson criteria is achieved by a randomized LRT of the form,
$$
\Psi(y, U) = \begin{cases}
1 & \frac{P_1(y)}{P_0(y)} > t(\bar{\alpha}) \\
U & \frac{P_1(y)}{P_0(y)} = t(\bar{\alpha}) \\
0 & \text{else}
\end{cases}
$$
where $U \sim \mathsf{Ber}(\eta)$ and $\eta$ is such that $\E_U \E_0 [ \Psi(y, U)] = \bar{\alpha}$.
</p>
<p>
<strong>Remark</strong>: the quantities $\eta$ and $t(\bar{\alpha})$ are given in a non-explicit form.
</p>
            </div>
        </div>
        <div class="row">
        <p style="text-align: right; width:100%"><i><a href="../miscellany.html">Back...</a></i></p>
        </div>
    </body>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
    crossorigin="anonymous"></script>
</html>
