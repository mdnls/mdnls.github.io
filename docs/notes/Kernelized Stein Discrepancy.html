
<!DOCTYPE html>
    <head>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
        <link rel="stylesheet" type="text/css" href="../styles/styles.css">
        <link rel="icon" href="assets/icon.ico" />
        <meta name="google-site-verification" content="gGsyj98Hmr9mZj0-DQzJIAdOP3eJXZJZnM4_NF8Mai8" />
        <meta charset="utf-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"> 
        <title>Mara Daniels - MIT</title>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
            onload="renderMathInElement(document.body, {
                delimiters: [
                    {left: '$$', right: '$$', display: true},
                    {left: '$', right: '$', display: false},
                ],
                macros: {
                    '\\saeq': '\\{#1\\}',
                    '\\linf': '\\lim_{n \\to \\infty}',
                    '\\Alpha': '\\mathcal{A}',
                    '\\norm': '\\left\\lVert#1\\right\\rVert',
                    '\\ct': 'C^\\infty_c ( #1 )',
                    '\\lloc': 'L^1_{\\mathsf{loc}}( #1 )',
                    '\\Scr': '\\mathscr{S}',
                    '\\tmpr': '\\mathscr{S}',
                    '\\limnf': '\\liminf \\limits_{#1}',
                    '\\limsp': '\\limsup \\limits_{#1}',
                    '\\R': '{\\mathbb R}',
                    '\\C': '{\\mathbb C}',
                    '\\N': '{\\mathbb N}',
                    '\\Q': '{\\mathbb Q}',
                    '\\H': '{\\mathbb H}',
                    '\\S': '{\\mathbb S}',
                    '\\Z': '{\\mathbb Z}',
                    '\\E': '{\\mathbb E}',
                    '\\Var': '\\mathsf{Var}',
                    '\\Cov': '\\mathsf{Cov}',
                    '\\KL': '\\mathsf{KL}',
                    '\\Ent': '\\mathsf{Ent}',
                    '\\F': '{\\mathbb F}',
                    '\\Acl': '\\mathcal{A}',
                    '\\Bcl': '\\mathcal{B}',
                    '\\Ccl': '\\mathcal{C}',
                    '\\Dcl': '\\mathcal{D}',
                    '\\Ecl': '\\mathcal{E}',
                    '\\Fcl': '\\mathcal{F}',
                    '\\Gcl': '\\mathcal{G}',
                    '\\Hcl': '\\mathcal{H}',
                    '\\Jcl': '\\mathcal{J}',
                    '\\Kcl': '\\mathcal{K}',
                    '\\Lcl': '\\mathcal{L}',
                    '\\Mcl': '\\mathcal{M}',
                    '\\Ncl': '\\mathcal{N}',
                    '\\Ocl': '\\mathcal{O}',
                    '\\Pcl': '\\mathcal{P}',
                    '\\Qcl': '\\mathcal{Q}',
                    '\\Rcl': '\\mathcal{R}',
                    '\\Scl': '\\mathcal{S}',
                    '\\Tcl': '\\mathcal{T}',
                    '\\Ucl': '\\mathcal{U}',
                    '\\Vcl': '\\mathcal{V}',
                    '\\Wcl': '\\mathcal{W}',
                    '\\Xcl': '\\mathcal{X}',
                    '\\Ycl': '\\mathcal{Y}',
                    '\\Zcl': '\\mathcal{Z}',
                    '\\diag': '\\mathrm{diag}',
                    '\\supp': '\\mathrm{supp}',
                    '\\diam': '\\mathrm{diam}',
                    '\\sgn': '\\mathrm{sgn}',
                    '\\im': '\\mathrm{Im}',
                    '\\lcm': '\\mathrm{lcm}',
                    '\\aut': '\\mathrm{Aut}',
                    '\\inn': '\\mathrm{Inn}',
                    '\\rg': '\\mathrm{rg}',
                    '\\vol': '\\mathrm{vol}',
                    '\\Pr': '\\mathrm{Pr}',
                    '\\Tr': '\\mathrm{Tr}',
                    '\\eps': '\\varepsilon',
                    '\\charfct': '\\mathds{1}',
                    '\\nullfct': '{\\bf 0}',
                    '\\as': '\\text{a.s.}\\xspace',
                    '\\argmax': '\\mathop{\\mathrm{arg\\,max}}',
                    '\\argmin': '\\mathop{\\mathrm{arg\\,min}}',
                    '\\esssup': '\\mathop{\\mathrm{ess\\,sup}}',
                    '\\th': '\\hat{\\theta}',
                    '\\pto': '\\stackrel{p}{\\longrightarrow}',
                    '\\dto': '\\stackrel{d}{\\longrightarrow}',
                    '\\asto': '\\stackrel{a.s.}{\\longrightarrow}',
                    '\\coloneqq': ':='
                }
            });">
            </script>
    </head>
    <body>
        <div class="row">
            <div class="col-lg-12 col-xl-8 offset-xl-2"> 
            <h1>Kernelized Stein Discrepancy</h1>
<p>
The kernelized stein discrepancy is defined as
</p>
<hr />
<p>
<strong>Definition (KSD)</strong> let $p, q \in \Pcl(\R^d)$ and let $\Acl_p$ be the <a href="Stein Discrepancy.html">Stein Operator</a>. The KSD is
$$
d_k(p, q) = \sup_{f \in \Hcl^d_k} (\Tr \E_q[\Acl_p f(x)])^2
$$
where $\Hcl^d_k$ is the ($d$-way tensor product of the) RKHS with kernel $k$.
</p>
<hr />
<p>
I am glossing over the regularity conditions on $p, q$ and also the symmetry/integrability conditions on $k$. See <a href="https://arxiv.org/pdf/1602.03253">Liu, Lee, Jordan KSD for Goodness of fit</a>.
</p>
<hr />
<p>
<strong>Proposition (Equivalent characterizations of KSD)</strong>. The KSD can be written in the following ways.
$$
\begin{aligned}
d(p, q) & = \sup_{f \in \Hcl^d_k} (\Tr \E_q[\Acl_p f(x)])^2
\\
& = \| \E_{x \sim q}[(s_p(x) - s_q(x))k(x, \cdot)] \|_{\Hcl^d_k}^2 \\
& = \Tr\E_{x, y \sim q}[(s_p(x) - s_q(x)) k(x, y) (s_p - s_q(x))^T]
\\
& = \Tr \E_{x, y \sim q} [ \Acl_p \otimes \Acl_p\,  k(x, y)]
\\
\end{aligned}
$$
where $s_p(x) = \nabla \log p(x)$ and likewise for $s_q(x)$. Sometimes the second identity is written in the form
$$
\begin{aligned}
d(p, q) & = \E_{x, y \sim q}[u(x, y)]  \\
u(x, y) & = \Tr[\Acl_p \otimes \Acl_p\,  k(x, y)] \\
& = k(x, y) s_p(x) s_p(y)^T + \nabla_xk(x, y) s_p(y)^T + s_p(x) \nabla_y k(x, y)^T + \Tr ([\nabla_x \otimes \nabla_y) \, k(x, y)) \\
\end{aligned}
$$
</p>
<hr />
<p>
Before proving this, observe the key lemma:
</p>
<hr />
<p>
<strong>Lemma</strong>: $$ \Tr \E_{x \sim q}[\Acl_pf(x)] = \Tr\E_{x \sim q}[f(x) (s_p(x) - s_q(x))^T]$$
</p>
<hr />
<p>
Intuitively, one can sort-of imagine the Stein operator as replacing the (vector valued) $f(x)$ by the matrix valued $f(x)(s_p(x) - s_q(x))^T$. Note that $\Tr[f(x) g(x)^T] = \langle f(x), g(x) \rangle$. Also, recall that $\Hcl_k$ can be thought of heuristically as $\Hcl_k = K^{1/2} \Lcl^2$ with the inner product $\langle \cdot, \cdot \rangle_{k} = \langle K^{-1/2} \cdot, K^{-1/2} \cdot \rangle_2$. The dual space $\Hcl_k^*$ is heuristically $\Hcl^{-1/2} = K^{-1/2} \Lcl^2$ with inner product $\langle K^{1/2} \cdot, K^{1/2} \cdot \rangle_2$. The Stein Discrepancy is roughly like the norm $s_p(x) - s_q(x)$ against test functions $f \in \Hcl^*_k$ and, for this reason, the (non-inverted) kernel function appears in $d(p, q)$.
</p>
<p>
<em>Proof of proposition</em>.
$$
\begin{aligned}
\Tr\E_q[A_p f(x)] & = \E_q[\langle s_p(x) - s_q(x) , f(x)\rangle_2] \\
& = \E_q[\langle s_p(x) - s_q(x) , \langle f(\cdot), k(x, \cdot)\rangle_k\rangle_2] \\
& = \sum_{i=1}^d \langle f_i(\cdot), \E_{x\sim q}[(s_{p,i}(x)-s_{q,i}(x)) k(x, \cdot)]\rangle_k
\end{aligned}
$$
Taking the supremum over $f \in \Hcl^d_k$ we have
$$
\sup_{f \in \Hcl^d_k} \Tr \E_q[\Acl_pf(x)] = \|\E_{x \sim q}[(s_{p}(x) - s_q(x))k(x, \cdot)]\|_{\Hcl^d_k}^2.
$$
Use now the Hilbert structure to write
$$
\begin{aligned}
d(p, q) &= \langle E_{x \sim q}[(s_{p}(x) - s_q(x))k(x, \cdot)] , E_{y \sim q}[(s_{p}(y) - s_q(y))k(y, \cdot)] \rangle_{\Hcl^d_k} \\
& = \E_{x, y \sim q} [ (s_p(x) - s_q(x)) \langle k(x, \cdot), k(y, \cdot)\rangle_{\Hcl_k} (s_p(y) - s_q(y))] \\
& = \E_{x, y \sim q} [ (s_p(x) - s_q(x)) k(x, y) (s_p(y) - s_q(y))].
\end{aligned}
$$
Finally, apply the previous lemma backward (to both inputs of $k(x, y)$) to see that
</p>
            </div>
        </div>
        <div class="row">
        <p style="text-align: right; width:100%"><i><a href="../miscellany.html">Back...</a></i></p>
        </div>
    </body>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
    crossorigin="anonymous"></script>
</html>
