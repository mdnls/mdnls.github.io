
<!DOCTYPE html>
    <head>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
        <link rel="stylesheet" type="text/css" href="../styles/styles.css">
        <link rel="icon" href="assets/icon.ico" />
        <meta name="google-site-verification" content="gGsyj98Hmr9mZj0-DQzJIAdOP3eJXZJZnM4_NF8Mai8" />
        <meta charset="utf-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"> 
        <title>Mara Daniels - MIT</title>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
            onload="renderMathInElement(document.body, {
                delimiters: [
                    {left: '$$', right: '$$', display: true},
                    {left: '$', right: '$', display: false},
                ],
                macros: {
                    '\\saeq': '\\{#1\\}',
                    '\\linf': '\\lim_{n \\to \\infty}',
                    '\\Alpha': '\\mathcal{A}',
                    '\\norm': '\\left\\lVert#1\\right\\rVert',
                    '\\ct': 'C^\\infty_c ( #1 )',
                    '\\lloc': 'L^1_{\\mathsf{loc}}( #1 )',
                    '\\Scr': '\\mathscr{S}',
                    '\\tmpr': '\\mathscr{S}',
                    '\\limnf': '\\liminf \\limits_{#1}',
                    '\\limsp': '\\limsup \\limits_{#1}',
                    '\\R': '{\\mathbb R}',
                    '\\C': '{\\mathbb C}',
                    '\\N': '{\\mathbb N}',
                    '\\Q': '{\\mathbb Q}',
                    '\\H': '{\\mathbb H}',
                    '\\S': '{\\mathbb S}',
                    '\\Z': '{\\mathbb Z}',
                    '\\E': '{\\mathbb E}',
                    '\\Var': '\\mathsf{Var}',
                    '\\Cov': '\\mathsf{Cov}',
                    '\\KL': '\\mathsf{KL}',
                    '\\Ent': '\\mathsf{Ent}',
                    '\\F': '{\\mathbb F}',
                    '\\Acl': '\\mathcal{A}',
                    '\\Bcl': '\\mathcal{B}',
                    '\\Ccl': '\\mathcal{C}',
                    '\\Dcl': '\\mathcal{D}',
                    '\\Ecl': '\\mathcal{E}',
                    '\\Fcl': '\\mathcal{F}',
                    '\\Gcl': '\\mathcal{G}',
                    '\\Hcl': '\\mathcal{H}',
                    '\\Jcl': '\\mathcal{J}',
                    '\\Kcl': '\\mathcal{K}',
                    '\\Lcl': '\\mathcal{L}',
                    '\\Mcl': '\\mathcal{M}',
                    '\\Ncl': '\\mathcal{N}',
                    '\\Ocl': '\\mathcal{O}',
                    '\\Pcl': '\\mathcal{P}',
                    '\\Qcl': '\\mathcal{Q}',
                    '\\Rcl': '\\mathcal{R}',
                    '\\Scl': '\\mathcal{S}',
                    '\\Tcl': '\\mathcal{T}',
                    '\\Ucl': '\\mathcal{U}',
                    '\\Vcl': '\\mathcal{V}',
                    '\\Wcl': '\\mathcal{W}',
                    '\\Xcl': '\\mathcal{X}',
                    '\\Ycl': '\\mathcal{Y}',
                    '\\Zcl': '\\mathcal{Z}',
                    '\\diag': '\\mathrm{diag}',
                    '\\supp': '\\mathrm{supp}',
                    '\\diam': '\\mathrm{diam}',
                    '\\sgn': '\\mathrm{sgn}',
                    '\\im': '\\mathrm{Im}',
                    '\\lcm': '\\mathrm{lcm}',
                    '\\aut': '\\mathrm{Aut}',
                    '\\inn': '\\mathrm{Inn}',
                    '\\rg': '\\mathrm{rg}',
                    '\\vol': '\\mathrm{vol}',
                    '\\Pr': '\\mathrm{Pr}',
                    '\\Tr': '\\mathrm{Tr}',
                    '\\eps': '\\varepsilon',
                    '\\charfct': '\\mathds{1}',
                    '\\nullfct': '{\\bf 0}',
                    '\\as': '\\text{a.s.}\\xspace',
                    '\\argmax': '\\mathop{\\mathrm{arg\\,max}}',
                    '\\argmin': '\\mathop{\\mathrm{arg\\,min}}',
                    '\\esssup': '\\mathop{\\mathrm{ess\\,sup}}',
                    '\\th': '\\hat{\\theta}',
                    '\\pto': '\\stackrel{p}{\\longrightarrow}',
                    '\\dto': '\\stackrel{d}{\\longrightarrow}',
                    '\\asto': '\\stackrel{a.s.}{\\longrightarrow}',
                    '\\coloneqq': ':='
                }
            });">
            </script>
    </head>
    <body>
        <div class="row">
            <div class="col-lg-12 col-xl-8 offset-xl-2"> 
            <h1>Reproducing Kernel Hilbert Spaces</h1>
<p>
An RKHS is a common function space in statistics which is theoretically convenient to work with. They are one of the key tools in analyzing algorithms like and <a href="Smoothing Estimators for Nonparametric Regression.html#kernel-ridge-regression">Kernel Ridge Regression</a>.
</p>
<hr />
<p>
<strong>(Function analytic Definition)</strong> A reproducing kernel Hilbert space is a function space for which pointwise evaluation is a bounded functional. Let $\Hcl$ be a Hilbert space of real-valued functions on $\Xcl$ and suppose that $L_x : \Hcl \to \R$ defined by $L_xf = f(x)$ satisfies $|L_x f | \leq C_x \|f\|_{\Hcl}$ for all $f \in \Hcl$. Then $\Hcl$ is an RKHS.
</p>
<p>
The kernel associated with $\Hcl$ can be written in terms of the <a href="https://en.wikipedia.org/wiki/Riesz<em>representation</em>theorem">Reisz Representer</a> of $L_x$. Denote by $K_x \in \Hcl$ the Reisz representer of $L_x$, and define $K(x, y) = \langle K_x, K_y \rangle_{\Hcl}$.
</p>
<hr />
<hr />
<p>
<strong>(Spectral Definition for Mercer Kernels)</strong>. Suppose that $(\Xcl, P)$ is a compact measure space and that $K(x, y) : \Xcl \times \Xcl \to \R$ is a function with the following properties.
</p>
<ol>
<li>Symmetry: $K(x, y) = K(y, x)$.
</li>
<li>Positive definiteness: for $f \in \Lcl^2(\Xcl, P)$, we have $\int K(x, y) f(x) f(y)\, dP(x)\, d P(y) \geq 0$.
</li>
<li>Mercer condition: $\int K(x, y)^2 \, dP(x) \, d P(y) < \infty$.
</li>
</ol>
<p>
Then by <a href="Mercer's Theorem.html">Mercer's Theorem</a>, $K(x, y)$ admits an eigendecomposition $\{(\lambda_k, \phi_k)\}_{k \geq 0}$ such that $\int K(x, y) \phi_k(y) \, dP(x) = \mu_k \phi_k(x)$. The kernel is given by
$$
K(x, y) = \sum_{k \geq 0} \mu_k \phi_k(x) \phi_k(y)
$$
and it is the reproducing kernel of the space $(\Xcl, \langle \cdot, \cdot \rangle_{\Hcl})$ under the inner product
$$\begin{align*}
\langle f, g \rangle<em>{\Hcl} = \sum</em>{k \geq 0}  \frac{\langle f, \phi<em>k\rangle \langle g, \phi</em>k \rangle}{\mu_k}
\end{align*}
$$
</p>
<hr />
<p>
<em>Note</em>: it is important to pay attention to the difference between $\langle \cdot, \cdot \rangle$, the standard inner product on $\Lcl^2(\Xcl, P)$, and the kernel inner product $\langle \cdot, \cdot \rangle_\Hcl$, which can be thought of (informally) as $\langle K^{-1} f, g\rangle$. Intuitively, this captures the idea that functions with finite $\|f\|_{\Hcl} < \infty$ are in the range of $K$. When $\Lcl^2(\Xcl)$ is finite dimensional (such as when $\Xcl = [n]$) we can think of $K$ as a matrix and it is literally true that $\|f\|_{\Hcl} = \|K^{-1/2}f\|_{2}$ for $f \in \mathsf{Im}(K)$.
</p>
<p>
<em>Proof of inner product formula</em>: by the representer property, $\langle K(x, \cdot),\phi_k \rangle_{\Hcl} = \phi_k(x)$. But by linearity and by Mercer's theorem,
$$
\begin{align*}
\phi<em>k(x) = \langle K(x, \cdot), \phi</em>k\rangle<em>{\Hcl} & = \sum</em>{j \geq 0} \mu<em>k \langle \phi</em>j, \phi<em>k \rangle</em>{\Hcl}\,  \phi_j(x).
\end{align*}
$$
Since $\{\phi_k(x)\}_{k \geq 0}$ form a linearly independent basis, this identity forces $\mu_k \langle \phi_j, \phi_k \rangle_{\Hcl} = \delta_{ij} \implies \langle \phi_j, \phi_k \rangle_{\Hcl} = \mu_k^{-1}$.
</p>
<p>
For the sake of intuition, we can observe the reproducing property:
</p>
<ol>
<li>A function $f \in \Lcl^2(\Xcl, P)$ belongs to the Mercer RKHS whenever the sequence $\{\langle f, \phi_k \rangle\}_{k \geq 0}$ satisfies $\sum_{k \geq 0} \langle f, \phi_k\rangle^2/\mu_k < \infty$.
</li>
<li>The reproducing property is that:
</li>
</ol>
<p>
$$
\langle K(x, \cdot ), f \rangle<em>{\Hcl} = \sum</em>{k \geq 0} \frac{\langle f, \phi<em>k\rangle \langle K(x, \cdot), \phi</em>k\rangle} {\mu<em>k} = \sum</em>{k \geq 0} \langle f, \phi<em>k \rangle \phi</em>k(x) = f(x).
$$
</p>
<hr />
<p>
**(Feature map definition)**: one way to define a positive semidefinite kernel is to take $K(x, y) = \langle \Phi(x), \Phi(y) \rangle$ where $\Phi: \Xcl \to \Theta$ is an abstract feature map. If $K$ and $\Xcl$ satisfy the conditions of Mercer's theorem, then $K$ can be used to construct an RKHS.
</p>
<hr />
<p>
<em>Note</em>: we can also go in the 'reverse direction' and construct a feature map from the eigendecomposition of a generic Mercer kernel $K(x, y)$. Consider the map $\Phi(x) = \begin{bmatrix}\sqrt{\mu_0} \phi_0(x) & \sqrt{\mu_1}\phi_1(x) & \ldots & \end{bmatrix}$. Then it holds that
$$
\langle \Phi(x), \Phi(y) \rangle = \sum<em>{k \geq 0} \mu</em>k \phi<em>k(x) \phi</em>k(y) = K(x, y)
</p>
            </div>
        </div>
        <div class="row">
        <p style="text-align: right; width:100%"><i><a href="../miscellany.html">Back...</a></i></p>
        </div>
    </body>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
    crossorigin="anonymous"></script>
</html>
