
<!DOCTYPE html>
    <head>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
        <link rel="stylesheet" type="text/css" href="../styles/styles.css">
        <link rel="icon" href="assets/icon.ico" />
        <meta name="google-site-verification" content="gGsyj98Hmr9mZj0-DQzJIAdOP3eJXZJZnM4_NF8Mai8" />
        <meta charset="utf-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"> 
        <title>Mara Daniels - MIT</title>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
            onload="renderMathInElement(document.body, {
                delimiters: [
                    {left: '$$', right: '$$', display: true},
                    {left: '$', right: '$', display: false},
                ],
                macros: {
                    '\\saeq': '\\{#1\\}',
                    '\\linf': '\\lim_{n \\to \\infty}',
                    '\\Alpha': '\\mathcal{A}',
                    '\\norm': '\\left\\lVert#1\\right\\rVert',
                    '\\ct': 'C^\\infty_c ( #1 )',
                    '\\lloc': 'L^1_{\\mathsf{loc}}( #1 )',
                    '\\Scr': '\\mathscr{S}',
                    '\\tmpr': '\\mathscr{S}',
                    '\\limnf': '\\liminf \\limits_{#1}',
                    '\\limsp': '\\limsup \\limits_{#1}',
                    '\\R': '{\\mathbb R}',
                    '\\C': '{\\mathbb C}',
                    '\\N': '{\\mathbb N}',
                    '\\Q': '{\\mathbb Q}',
                    '\\H': '{\\mathbb H}',
                    '\\S': '{\\mathbb S}',
                    '\\Z': '{\\mathbb Z}',
                    '\\E': '{\\mathbb E}',
                    '\\Var': '\\mathsf{Var}',
                    '\\Cov': '\\mathsf{Cov}',
                    '\\KL': '\\mathsf{KL}',
                    '\\Ent': '\\mathsf{Ent}',
                    '\\F': '{\\mathbb F}',
                    '\\Acl': '\\mathcal{A}',
                    '\\Bcl': '\\mathcal{B}',
                    '\\Ccl': '\\mathcal{C}',
                    '\\Dcl': '\\mathcal{D}',
                    '\\Ecl': '\\mathcal{E}',
                    '\\Fcl': '\\mathcal{F}',
                    '\\Gcl': '\\mathcal{G}',
                    '\\Hcl': '\\mathcal{H}',
                    '\\Jcl': '\\mathcal{J}',
                    '\\Kcl': '\\mathcal{K}',
                    '\\Lcl': '\\mathcal{L}',
                    '\\Mcl': '\\mathcal{M}',
                    '\\Ncl': '\\mathcal{N}',
                    '\\Ocl': '\\mathcal{O}',
                    '\\Pcl': '\\mathcal{P}',
                    '\\Qcl': '\\mathcal{Q}',
                    '\\Rcl': '\\mathcal{R}',
                    '\\Scl': '\\mathcal{S}',
                    '\\Tcl': '\\mathcal{T}',
                    '\\Ucl': '\\mathcal{U}',
                    '\\Vcl': '\\mathcal{V}',
                    '\\Wcl': '\\mathcal{W}',
                    '\\Xcl': '\\mathcal{X}',
                    '\\Ycl': '\\mathcal{Y}',
                    '\\Zcl': '\\mathcal{Z}',
                    '\\diag': '\\mathrm{diag}',
                    '\\supp': '\\mathrm{supp}',
                    '\\diam': '\\mathrm{diam}',
                    '\\sgn': '\\mathrm{sgn}',
                    '\\im': '\\mathrm{Im}',
                    '\\lcm': '\\mathrm{lcm}',
                    '\\aut': '\\mathrm{Aut}',
                    '\\inn': '\\mathrm{Inn}',
                    '\\rg': '\\mathrm{rg}',
                    '\\vol': '\\mathrm{vol}',
                    '\\Pr': '\\mathrm{Pr}',
                    '\\Tr': '\\mathrm{Tr}',
                    '\\eps': '\\varepsilon',
                    '\\charfct': '\\mathds{1}',
                    '\\nullfct': '{\\bf 0}',
                    '\\as': '\\text{a.s.}\\xspace',
                    '\\argmax': '\\mathop{\\mathrm{arg\\,max}}',
                    '\\argmin': '\\mathop{\\mathrm{arg\\,min}}',
                    '\\esssup': '\\mathop{\\mathrm{ess\\,sup}}',
                    '\\th': '\\hat{\\theta}',
                    '\\pto': '\\stackrel{p}{\\longrightarrow}',
                    '\\dto': '\\stackrel{d}{\\longrightarrow}',
                    '\\asto': '\\stackrel{a.s.}{\\longrightarrow}',
                    '\\coloneqq': ':='
                }
            });">
            </script>
    </head>
    <body>
        <div class="row">
            <div class="col-lg-12 col-xl-8 offset-xl-2"> 
            <h1>Kalman Filtering</h1>
<p>
Kalman Filtering is an algorithm for solving <a href="Sequential Inference.html">filtering problems</a> which have:
</p>
<ol>
<li>Linear dynamics with additive gaussian noise
</li>
<li>Linear gaussian observation model (cf. <a class="broken" href="#">Linear Gaussian Inverse Problem</a>)
</li>
</ol>
<h2 id="vanilla-kalman-filtering">Vanilla Kalman Filtering</h2>
<p>
These two modeling assumptions can be written explicitly as follows. Let $(X_t, Y_t)_{t \in \N} \subseteq \R^d \otimes \R^d$ be a random process where
</p>
<ol>
<li>$X_0 \sim \Ncl(\mu_0, \Sigma_0)$.
</li>
<li>$X_{t+1} = M X_{t} + E_t$ where $E_t \sim \Ncl(0, Q_t)$ independent of $(X_t, Y_t)_{t \in \N}$ and $M_t, Q_t \in \R^{d \times d}$ are unknown.
</li>
<li>$Y_{t+1} = H X_{t+1} + e_t$ where $e_t \sim \Ncl(0, R)$ independent of $(X_t, Y_t)_{t \in \N}$ and $R_t \in \R^{d \times d}$ is unknown.
</li>
</ol>
<p>
By <a href="Gaussian Space.html">Gaussian Conditioning</a>, we can derive a recursion for <em>prior parameters</em> $(x_t^-, C_t^-)$ and <em>posterior parameters</em> $(x_t^+, C_t^+)$, such that
$$
X_t \mid Y_{1:t-1}\sim \mathcal{N}(x_t^-, C_t^-) \qquad X_t \mid Y_{1:t} \sim \Ncl(x_t^+, C_t^+)
$$
This will also allow us to predict $Y_t \mid Y_{1:t-1} \sim \Ncl(Hx_t^-, H C_t^- H^T)$. The recursion is:
</p>
<ol>
<li>Forward time step: $x^-_t = M x^+_{t-1}$ and $C_t^- = M C^+_{t-1} M^T + Q_t$.
</li>
<li>Gaussian conditioning: we condition $X_t \mid Y_{1 : t-1}$ on $Y_{t}$ to see that $$
</li>
</ol>
<p>
X^+_t = X_t^- + G(Y_t - H x_t^-) \qquad C^+_t = C^-_t - G H C_t^- = (I-GH)C^-_t.
$$
where $G_t = C_t^- H^T ( H C_t^- H^T + R)^{-1}$  is the <em>Kalman Gain</em>. In terms of Gaussian Conditioning, this matrix has the form $\Sigma_{XY} \Sigma_Y^{-1}$.
</p>
<h2 id="ensemble-kalman-filtering">Ensemble Kalman Filtering</h2>
<p>
One way to motivate the ensemble Kalman Filter is by viewing the Kalman recursion as a <em>linear transformation applied to Monte-Carlo samples</em>. Specifically, if $X_t, Y_t \mid \Ycl_{1 : t-1} \sim \pi_{X, Y}$ we can write a linear transformation to compute $X_t \mid \Ycl_{1:t}$:
$$
Z^i = X^i - G(Y^i - Y^*) \qquad \implies \qquad Z^i \stackrel{(d)}{=} X_t \mid \Ycl_{1:t}.
$$
In this notation, $\Ycl_{1:t}$ is a fixed set of values (such as the past observations), while $Y^i$ is a random variable whose distribution we seek to model.
</p>
<p>
In the Ensemble Kalman Filter, we imagine a potentially nonlinear model
$$
\begin{aligned}
X_t & = M(X_{t-1}) + E_{t-1} \\
Y_t & = H X_t + e_t
\end{aligned}
$$
where $M : \R^d \to \R^d$ is a potentially nonlinear function. We can use $M$ in a particle-based recursion inspired by the linear filtering problem:
</p>
<ol>
<li>By forecasting, sample $\left\{X_{t-1}^{+, i} \right\}_{i=1}^n \sim \tilde{\pi}_{X_{t-1} \mid \Ycl_{1:t-1}}$, where $\tilde{\pi}$ is a TBD approximation of $\pi_{X_t\ \mid \Ycl_{1:1-t}}$ (see step 3).   These samples are known as the 'forecast ensemble members.'
</li>
<li>Step the system forward in time: $X_t^{-, i} = M(X_{t-1}^{+, i}) + E^i_{t-1}$ where $E^i_{t-1} \sim \Ncl(0, Q_{t-1})$.
</li>
<li>Next, compute the Bayesian update for $\tilde{\pi}_{X_t \mid \Ycl_{1:t}}$ by generating samples from it in the following way.
<ul>
<li>Estimate a covariance $\hat{C}_t^- = \Cov({X_{t-1}^{+}})$ using the empirical covariance of the forecast ensemble members.
</li>
<li>Use this covariance to estimate the Kalman gain. $\hat{G}_t = \hat{C}_t^- H^T(H \hat{C}^-_t H^T + R)^{-1}$
</li>
<li>Update the forecast ensemble by applying the <em>linear Gaussian update</em> to the $\{X_t^{-, i}\}_{i=1}^n$ even though they are explicitly not generated from a Gaussian model.
</li>
</ul>
</li>
</ol>
<p>
$$ X^{+, i}_t = X^{-, i}_t + \hat{G}_t (Y_t^* - \underbrace{H X^{-, i}_t - e_t^i)}_{\text{sample } Y^i_t \mid X_t^i= X_t^{-, i}}$$
</p>
            </div>
        </div>
        <div class="row">
        <p style="text-align: right; width:100%"><i><a href="../miscellany.html">Back...</a></i></p>
        </div>
    </body>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
    crossorigin="anonymous"></script>
</html>
