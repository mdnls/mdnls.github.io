
<!DOCTYPE html>
    <head>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
        <link rel="stylesheet" type="text/css" href="../styles/styles.css">
        <link rel="icon" href="assets/icon.ico" />
        <meta name="google-site-verification" content="gGsyj98Hmr9mZj0-DQzJIAdOP3eJXZJZnM4_NF8Mai8" />
        <meta charset="utf-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"> 
        <title>Mara Daniels - MIT</title>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
            onload="renderMathInElement(document.body, {
                delimiters: [
                    {left: '$$', right: '$$', display: true},
                    {left: '$', right: '$', display: false},
                ],
                macros: {
                    '\\saeq': '\\{#1\\}',
                    '\\linf': '\\lim_{n \\to \\infty}',
                    '\\Alpha': '\\mathcal{A}',
                    '\\norm': '\\left\\lVert#1\\right\\rVert',
                    '\\ct': 'C^\\infty_c ( #1 )',
                    '\\lloc': 'L^1_{\\mathsf{loc}}( #1 )',
                    '\\Scr': '\\mathscr{S}',
                    '\\tmpr': '\\mathscr{S}',
                    '\\limnf': '\\liminf \\limits_{#1}',
                    '\\limsp': '\\limsup \\limits_{#1}',
                    '\\R': '{\\mathbb R}',
                    '\\C': '{\\mathbb C}',
                    '\\N': '{\\mathbb N}',
                    '\\Q': '{\\mathbb Q}',
                    '\\H': '{\\mathbb H}',
                    '\\S': '{\\mathbb S}',
                    '\\Z': '{\\mathbb Z}',
                    '\\E': '{\\mathbb E}',
                    '\\Var': '\\mathsf{Var}',
                    '\\Cov': '\\mathsf{Cov}',
                    '\\KL': '\\mathsf{KL}',
                    '\\Ent': '\\mathsf{Ent}',
                    '\\F': '{\\mathbb F}',
                    '\\Acl': '\\mathcal{A}',
                    '\\Bcl': '\\mathcal{B}',
                    '\\Ccl': '\\mathcal{C}',
                    '\\Dcl': '\\mathcal{D}',
                    '\\Ecl': '\\mathcal{E}',
                    '\\Fcl': '\\mathcal{F}',
                    '\\Gcl': '\\mathcal{G}',
                    '\\Hcl': '\\mathcal{H}',
                    '\\Jcl': '\\mathcal{J}',
                    '\\Kcl': '\\mathcal{K}',
                    '\\Lcl': '\\mathcal{L}',
                    '\\Mcl': '\\mathcal{M}',
                    '\\Ncl': '\\mathcal{N}',
                    '\\Ocl': '\\mathcal{O}',
                    '\\Pcl': '\\mathcal{P}',
                    '\\Qcl': '\\mathcal{Q}',
                    '\\Rcl': '\\mathcal{R}',
                    '\\Scl': '\\mathcal{S}',
                    '\\Tcl': '\\mathcal{T}',
                    '\\Ucl': '\\mathcal{U}',
                    '\\Vcl': '\\mathcal{V}',
                    '\\Wcl': '\\mathcal{W}',
                    '\\Xcl': '\\mathcal{X}',
                    '\\Ycl': '\\mathcal{Y}',
                    '\\Zcl': '\\mathcal{Z}',
                    '\\diag': '\\mathrm{diag}',
                    '\\supp': '\\mathrm{supp}',
                    '\\diam': '\\mathrm{diam}',
                    '\\sgn': '\\mathrm{sgn}',
                    '\\im': '\\mathrm{Im}',
                    '\\lcm': '\\mathrm{lcm}',
                    '\\aut': '\\mathrm{Aut}',
                    '\\inn': '\\mathrm{Inn}',
                    '\\rg': '\\mathrm{rg}',
                    '\\vol': '\\mathrm{vol}',
                    '\\Pr': '\\mathrm{Pr}',
                    '\\Tr': '\\mathrm{Tr}',
                    '\\eps': '\\varepsilon',
                    '\\charfct': '\\mathds{1}',
                    '\\nullfct': '{\\bf 0}',
                    '\\as': '\\text{a.s.}\\xspace',
                    '\\argmax': '\\mathop{\\mathrm{arg\\,max}}',
                    '\\argmin': '\\mathop{\\mathrm{arg\\,min}}',
                    '\\esssup': '\\mathop{\\mathrm{ess\\,sup}}',
                    '\\th': '\\hat{\\theta}',
                    '\\pto': '\\stackrel{p}{\\longrightarrow}',
                    '\\dto': '\\stackrel{d}{\\longrightarrow}',
                    '\\asto': '\\stackrel{a.s.}{\\longrightarrow}',
                    '\\coloneqq': ':='
                }
            });">
            </script>
    </head>
    <body>
        <div class="row">
            <div class="col-lg-12 col-xl-8 offset-xl-2"> 
            <h1>Transport and Continuity PDEs</h1>
<p>
The <em>continuity PDE</em> is given by
$$
\partial_t \rho_t(x) + \nabla \cdot(\rho_t(x) v_t(x))= 0
$$
with initial conditions given by $\rho_0(x) : \R^d \to \R$ and $v_t(x) : \R^d \to \R^d$. A solution $(\rho_t)_{t \geq 0}$ to this equation can be interpreted as a time-varying density over $\R^d$. As we will see below, the integral $\int_{\R^d} \rho_t(x) \, dx$ is conserved, which has the physical interpretation of <em>mass conservation</em>.
</p>
<p>
The <em>transport PDE</em> is given by
$$
\partial_t \Psi_t(x) + \langle \nabla_x \Psi_t(x), v_t(x)\rangle = 0
$$
with initial conditions given by $\Psi_0(x) : \R^d \to \R^d$ and $v_t(x) : \R^d \to \R^d$. It turns out that this PDE is solved by
$$
\Psi_t(x) = (\Psi_0 \circ \phi_t^{-1})(x)
$$
where $\phi_t(x)$ is the flow map induced by $v_t(x)$:
$$
\partial_t \phi_t(x) = v_t(\phi_t(x)).
$$
The physical interpretation of this map is that, if $v_t(x)$ represents the velocity of a particle at location $x\in \R^d$ and at time $t > 0$, then $\phi_t(x)$ computes the future location (at time $t$) of $x$ at time $0$.
</p>
<h3 id="solution-via-method-of-characteristics">Solution via Method of Characteristics</h3>
<p>
Here is a solution using the <a href="Method of Characteristics.html">Method of Characteristics</a>. We claim that the flow map $\phi_t(x)$ can be interpreted as a characteristic curve for the continuity PDE:
$$
\begin{aligned}
\partial_t[\rho_t(\phi_t(x))] & = (\partial_t \rho_t)(\phi_t(x)) + \langle (\nabla_x \rho_t)(\phi_t(x)), \partial_t \phi_t(x) \rangle \\
& = - \rho_t(\phi_t(x)) (\nabla \cdot v_t(\phi_t(x))) \\
& \qquad + \langle (\nabla_x \rho_t)(\phi_t(x)), v_t(\phi_t(x)) - \partial_t \phi_t(x)\rangle
\end{aligned}
$$
where the second line follows from rewriting $\partial_t \rho_t$ with the continuity PDE. It is clear from this expression that the choice
$$
\partial_t\phi_t(x) = v_t(\phi_t(x))
$$
cancels the appearance of the partial derivative $\nabla_x \rho_t$, leaving only an ODE in time.
</p>
<hr />
<p>
<strong>Proposition (Decoupled Characteristic ODEs for Continuity PDE)</strong>. The continuity PDE is equivalent to the pair of ODEs,
$$
\begin{cases}
\partial_t \phi_t(x) = v_t(\phi_t(x)) \\
\partial_t \rho_t(z) = (\nabla \cdot v_t(z)) \rho_t(z)
\end{cases}
$$
where we used the formal substitution $z = \phi_t(x)$.
</p>
<hr />
<h3 id="conservation-of-mass">Conservation of Mass</h3>
<p>
Take a generic test function $\Psi_0 \in C^\infty_c(\R^d)$ and set $\Psi_t(x) = (\Psi_0 \circ \phi_t^{-1})(x)$. By construction, $(\Psi_t\circ \phi_t)(x)$ is constant, so that
$$
0 = \partial_t(\Psi_t \circ \phi_t)(x) = (\partial_t \Psi_t)(\phi_t(x)) + \langle \nabla_x \Psi_t(\phi_t(x)), v_t(\phi_t(x)) \rangle
$$
and substituting $z = \phi_t(x)$ we recover the <a href="Transport and Continuity PDEs.html">transport equation</a>.
</p>
<p>
We have that
$$
\begin{aligned}
\partial_t \int \Psi_t(x) \rho_t(x) \, dx & =- \int \left[ \langle \nabla_x \Psi_t(x), v_t(x) \rangle \rho_t(x) + \nabla \cdot(\rho_t(x) v_t(x)) \Psi_t(x)\right]  = 0
\end{aligned}
$$
since we have by integration by parts that
$$
\int \langle \nabla_x \Psi_t(x), v_t(x) \rangle \rho_t(x) \, dx = - \int \nabla \cdot(\rho_t(x) v_t(x)) \Psi_t(x) \, dx.
$$
</p>
<hr />
<p>
<strong>Proposition (Pushforward by Flow Map)</strong>. What we have shown is that, for any test function $\Psi_0 \in C^\infty_c(\R^d)$,
$$
\int \Psi_0(x) \rho_0(x) \, dx = \int \Psi_0(\phi_t^{-1}(x)) \rho_t(x) \, dx \iff \int \Phi_0(\phi_t(x)) \rho_0(x) \, dx = \int \Phi_0(x) \rho_t(x) \, dx .
$$
Equivalently, the random variable $X_t \sim \rho_t$ has the same law as $\phi_t(X_0)$ when $X_0 \sim \rho_0$.
</p>
<hr />
<p>
<strong>Remarks</strong>:
</p>
<ol>
<li>Taking $\Psi_0(x) =1$, we see that $\int \rho_t(x) \, dx$ is conserved over time.
</li>
<li>The upshot is that the continuity equation is special because it has a nice connection between PDE and probabilistic interpretations. Under the PDE interpretation, the flow map $\phi_t(x)$ parametrizes the characteristic curves of the solution $(\rho_t)_{t \geq 0}$. Under the probabilistic interpretation, $\rho_t$ is a pushforward by $\phi_t$.
</li>
</ol>
            </div>
        </div>
        <div class="row">
        <p style="text-align: right; width:100%"><i><a href="../miscellany.html">Back...</a></i></p>
        </div>
    </body>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
    crossorigin="anonymous"></script>
</html>
